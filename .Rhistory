OUTPUT
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 14, width = 12)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 2.5, 0.5))
dev.off()
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 14, width = 9)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 2.5, 0.5))
dev.off()
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 14, width = 11)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 3, 0.7))
dev.off()
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 17, width = 11)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 3, 0.7))
dev.off()
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 17, width = 12)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 3, 0.7))
dev.off()
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 17, width = 12)
sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3.2, 3, 0.7))
dev.off()
all_sbs_plots <- sbs96_plt + sbs1536_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3.2, 3, 0.7))
pdf(paste0(OUTPUT, "/SBS96_SBS1536_SPv00561_exposures.pdf"), height = 17, width = 12)
patchwork::wrap_elements(all_sbs_plots) +
ggtitle("extractor - v0.0.5.61")+
theme(plot.title = element_text(size = 14, face = "bold"))
dev.off()
dbs78_plt <- SignaturesPlot_PCAWGstyle_dbs_xt(sigProfiler_decomposed_df_annotations = sigProfiler_decomposed_dbs_annos, sigs_order = DBS_order)
id83_plt <- SignaturesPlot_PCAWGstyle_id_xt(sigProfiler_decomposed_df_annotations = sigProfiler_decomposed_id_annos, sigs_order = ID_order)
id83_plt
dbs78_plt
id83_plt
SignaturesPlot_PCAWGstyle_id_xt <- function(sigProfiler_decomposed_df_annotations, sigs_order = SBS_order){
## sigProfiler_decomposed_df_annotations <- should be following format
# SAMPLE_IDENTIFIER SUBGROUP SBS1 SBS3 SBS5 SBS6 SBS7c SBS8 SBS18 SBS25 SBS30 SBS37 SBS39 SBS43
# ICGC_LFS_MB1      SHH    0    0    0    0     0 1057     0     0     0     0     0     0
# ICGC_LFS_MB2      SHH    0    0    0    0     0    0     0     0     0     0     0     0
exposures_annotations <- sigProfiler_decomposed_df_annotations
## compute mutations/Mb sue to signature here
exposures_annotations_mlt <- exposures_annotations %>%
dplyr::select(-c(SUBGROUP)) %>%
reshape2::melt()
all_pid <- exposures_annotations_mlt$SAMPLE_IDENTIFIER %>% as.character() %>% unique()
mut_per_mb_dueSig <- NULL
for(i in 1:length(all_pid)){
my_pid <- all_pid[i]
my_pid_res <- exposures_annotations_mlt %>%
dplyr::filter(SAMPLE_IDENTIFIER == get("my_pid")) %>%
merge(sampleAnnotations_coveredBases, by.x = "SAMPLE_IDENTIFIER", by.y = "PID") %>%
dplyr::mutate(sig_mut_mb = value/(COVERED_BASES/1000000)) %>%
dplyr::mutate(tt = paste0(SAMPLE_IDENTIFIER, "__", ENTITY)) %>%
dplyr::select(tt, variable, sig_mut_mb) %>%
data.table::dcast(tt ~ variable) %>%
tidyr::separate(col = tt, into = c("SAMPLE_IDENTIFIER", "ENTITY"), sep = "__", extra = "merge")
mut_per_mb_dueSig <- plyr::rbind.fill(mut_per_mb_dueSig, my_pid_res)
}
## subgroup annotation is not extensive in above loop
## re-annotate
exposures_annotations <- mut_per_mb_dueSig %>%
dplyr::select(-c(ENTITY)) %>%
merge(exposures_annotations %>% dplyr::select(SAMPLE_IDENTIFIER, SUBGROUP), by = "SAMPLE_IDENTIFIER") %>%
dplyr::select(SAMPLE_IDENTIFIER, SUBGROUP, everything())
## 0
exposures_annotations_fmt1 <- exposures_annotations %>%
dplyr::count(SUBGROUP) %>%
dplyr::mutate(SUBGROUP_N = paste0(SUBGROUP, " (n=", n, ")")) %>%
dplyr::select(-c(n)) %>%
merge(exposures_annotations, by = "SUBGROUP") %>%
dplyr::select(-c(SUBGROUP, SAMPLE_IDENTIFIER))
exposures_annotations_fmt1_mlt <- exposures_annotations_fmt1 %>%
reshape2::melt()
## 1
## for each subgroup and each signature: median of non-0 samples
## for each subgroup, fraction of non-0 samples
## median per-subgroup, per-signature
exposures_medianMuts <- exposures_annotations_fmt1_mlt %>%
dplyr::filter(value != 0) %>%
dplyr::group_by_(.dots = c("SUBGROUP_N", "variable")) %>%
dplyr::summarise(median_mutations = median(value))
## fraction of samples that show signature out of all samples
exposures_nonZeroSamples <- exposures_annotations_fmt1_mlt %>%
dplyr::filter(value != 0) %>%
dplyr::group_by(SUBGROUP_N) %>%
dplyr::count(variable) %>%
dplyr::rename(non_zero_samples = n)
exposures_allSamples <- exposures_annotations_fmt1_mlt %>%
dplyr::group_by(SUBGROUP_N) %>%
dplyr::count(variable)
## calculate fraction
exposures_fractionSamples <- dplyr::left_join(exposures_nonZeroSamples, exposures_allSamples) %>%
dplyr::mutate(fraction_n_sig = non_zero_samples/n) %>%
dplyr::select(SUBGROUP_N, variable, fraction_n_sig)
## create a table with median_muts, fraction_samples
exposures_Medians_Fractions <- dplyr::left_join(exposures_medianMuts, exposures_fractionSamples)
## ordering of signatures
common_sigs <- intersect(sigs_order, exposures_Medians_Fractions$variable)
diff_sigs <- setdiff(exposures_Medians_Fractions$variable, sigs_order)
all_sigs <- c(common_sigs, diff_sigs)
exposures_Medians_Fractions$variable <- factor(exposures_Medians_Fractions$variable, levels = rev(all_sigs))
#exposures_Medians_Fractions$SUBGROUP_N <- factor(exposures_Medians_Fractions$SUBGROUP_N, levels = c("WNT (n=19)", "SHH (n=40)", "Group3 (n=56)", "Group4 (n=95)"))
exposures_Medians_Fractions_xn <- exposures_Medians_Fractions %>%
dplyr::mutate(tt = SUBGROUP_N) %>%
tidyr::separate(tt, into = c("entity", "entity_n"), sep = " ") %>%
dplyr::mutate(entity_n = gsub("\\(", "", entity_n),
entity_n = gsub("\\)", "", entity_n),
entity_n = gsub("n=", "", entity_n))
exposures_Medians_Fractions_xn$entity_n <- factor(exposures_Medians_Fractions_xn$entity_n, levels = unique(exposures_Medians_Fractions_xn$entity_n))
tt <- exposures_Medians_Fractions_xn
tt2 <- tt %>%
data.table::dcast(SUBGROUP_N~variable, value.var = "median_mutations") %>%
reshape2::melt() %>%
dplyr::left_join(tt %>% dplyr::select(-c(median_mutations,entity, entity_n)))
tt2$tile_col <- rep(c(1,0), dim(tt2)[1]/2)
tt2$tile_col <- as.factor(tt2$tile_col)
# tt3 <- tt2 %>%
#   tidyr::separate(SUBGROUP_N, into = c("entity", "entity_n"), sep = " ") %>%
#   dplyr::mutate(entity_n = gsub("\\(", "", entity_n),
#                 entity_n = gsub("\\)", "", entity_n),
#                 entity_n = gsub("n=", "", entity_n))
#
# tt3$entity_n <- factor(tt3$entity_n, levels = unique(tt3$entity_n))
ggplot(tt2, aes(x = SUBGROUP_N, y = variable, fill = tile_col, size = fraction_n_sig, color = value))+
geom_tile(size = 0.5, color = "white")+
scale_fill_manual(values = c("1" = "gray95", "0" = "gray85"))+
geom_point()+
scale_color_gradientn(colours = rev(rainbow(10)),
limits = c(0, 0.08),
breaks = c(0, 0.01, 0.03, 0.05, 0.08),
labels = c(0, 0.01, 0.03, 0.05, 0.08),
name = "Median mutations/Mb\ndue to signature",
guide = guide_colourbar(barwidth=1.3, barheight = 15,
title.position = "right",
title.theme = element_text(angle = 90, size = 18)))+
theme_minimal(base_size = 20)+
theme(axis.text = element_text(color = "black", size = 18),
axis.text.x = element_text(color = xlab_colors, size = 18),
axis.title = element_text(size = 20),
panel.grid = element_blank(),
legend.text = element_text(size = 16),
legend.title = element_text(size = 20))+
ggpubr::rotate_x_text(angle = 90, hjust = 1)+
xlab("")+
ylab("Indel Signatures")+
scale_size(guide = 'none')+
guides(fill = 'none')
# scale_size(breaks = c(0.2, 0.4, 0.6, 0.8, 1),
#            labels = c("20%", "40%", "60%", "80%", "100%"))+
# guides(fill = 'none')
}
id83_plt <- SignaturesPlot_PCAWGstyle_id_xt(sigProfiler_decomposed_df_annotations = sigProfiler_decomposed_id_annos, sigs_order = ID_order)
sbs_dbs_id_plts <- sbs96_plt + dbs78_plt + id83_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 1, 1.5, 0.5))
pdf(paste0(OUTPUT, "/SBS96_DBS78_ID83_SPv00561_exposures.pdf"), height = 17, width = 12)
patchwork::wrap_elements(sbs_dbs_id_plts) +
ggtitle("extractor - v0.0.5.61")+
theme(plot.title = element_text(size = 14, face = "bold"))
dev.off()
sbs_dbs_id_plts <- sbs1536_plt + dbs78_plt + id83_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 1, 1.5, 0.5))
pdf(paste0(OUTPUT, "/SBS96_DBS78_ID83_SPv00561_exposures.pdf"), height = 17, width = 12)
patchwork::wrap_elements(sbs_dbs_id_plts) +
ggtitle("extractor - v0.0.5.61")+
theme(plot.title = element_text(size = 14, face = "bold"))
dev.off()
sbs_dbs_id_plts <- sbs96_plt + dbs78_plt + id83_plt + sbs1536_plt_lgplt +
patchwork::plot_layout(ncol = 1, heights = c(3, 1, 1.5, 0.5))
pdf(paste0(OUTPUT, "/SBS96_DBS78_ID83_SPv00561_exposures.pdf"), height = 17, width = 12)
patchwork::wrap_elements(sbs_dbs_id_plts) +
ggtitle("extractor - v0.0.5.61")+
theme(plot.title = element_text(size = 14, face = "bold"))
dev.off()
save.image("SignaturePlots_SPv00561.R.RData")
pdf(paste0(OUTPUT, "/SBS96_DBS78_ID83_SPv00561_exposures.pdf"), height = 17, width = 12.5)
patchwork::wrap_elements(sbs_dbs_id_plts) +
ggtitle("extractor - v0.0.5.61")+
theme(plot.title = element_text(size = 14, face = "bold"))
dev.off()
219-146
setwd("~/Desktop/ServerView/BRCA/scripts/sigProfiler_pedpancan/signatureAnalysis_XX/signatureExtraction")
library(tidyverse)
INPUT <- "~/Desktop/ServerView/BRCA/results/sigProfiler_pedpancan/signatureAnalysis_XX/signatureExtraction/combined_nohyper/"
INPUT <- "~/Desktop/ServerView/BRCA/results/sigProfiler_pedpancan/signatureAnalysis_XX/signatureExtraction/combined_nohyper"
sbs3 <- read.delim(paste0(INPUT, "/wgs_snv_signatures_1536_v5.61/SBS1536/Suggested_Solution/Decomposed_Solution/Decomposed_Solution_Activities.txt"), header = TRUE)
sbs3 %>% head
sbs3 %>%
dplyr::select(Samples, SBS3) %>% head
sbs3 %>%
dplyr::select(Samples, SBS3) %>%
dplyr::filter(SBS3 > 0) %>% dim
sbs3 %>% dim
sbs3 <- sbs3 %>%
dplyr::select(Samples, SBS3) %>%
dplyr::filter(SBS3 > 0)
id_g <- read.delim(paste0(INPUT, "/wgs_id_signatures_v5.61/ID83/Suggested_Solution/Decomposed_Solution/Decomposed_Solution_Activities.txt"), header = TRUE)
id_g %>% head()
sbs3 <- read.delim(paste0(INPUT, "/wgs_snv_signatures_1536_v5.61/SBS1536/Suggested_Solution/Decomposed_Solution/Decomposed_Solution_Activities.txt"), header = TRUE)
sbs3 <- sbs3 %>%
dplyr::select(Samples, SBS3)
id_g <- id_g %>%
dplyr::select(Samples, Signature.G)
id_g %>% dim
sbs3 %>% dplyr::left_join(id_g) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 == 0 & Signature.G == 0)
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 != 0 & Signature.G != 0)
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 != 0 & Signature.G != 0) %>% dim
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 == 0 & Signature.G == 0) %>% dim()
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 == 0 & Signature.G == 0) %>% head
sbs3 %>% dplyr::left_join(id_g) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
rowSums()
sbs3 %>% dplyr::left_join(id_g) %>%
head
sbs3 %>% dplyr::left_join(id_g) %>%
tibble::column_to_rownames(Samples) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
tibble::column_to_rownames(var = "Samples") %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
tibble::column_to_rownames(var = "Samples") %>%
rowSums()
sbs3 %>% dplyr::left_join(id_g) %>%
tibble::column_to_rownames(var = "Samples") %>%
dplyr::mutate(ssum = rowSums())
sbs3 %>% dplyr::left_join(id_g) %>%
tibble::column_to_rownames(var = "Samples") %>% head
sbs3 %>% dplyr::left_join(id_g) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 | Signature.G > 0) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 & Signature.G > 0) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 && Signature.G > 0) %>% head
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 & Signature.G > 0) %>% head
sbs3_sigG_both_yes <- sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 & Signature.G > 0)
## any one is yes
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 | Signature.G > 0) %>% dim
sbs3_sigG_any1_yes <- sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 | Signature.G > 0)
library(ggpubr)
sbs3_sigG_both_yes %>% head
ggscatter(sbs3_sigG_both_yes, x = "SBS3", y = "Signature.G")
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3", y = "Signature.G")+
coord_trans(x = "log2", y = "log2")
sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 & Signature.G > 0) %>% head
sbs3_sigG_both_yes <- sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 & Signature.G > 0) %>%
dplyr::mutate(SBS3_log = log2(SBS3),
Signature.G_log = log2(Signature.G))
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor()
sbs3_sigG_any1_yes <- sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 | Signature.G > 0) %>%
dplyr::mutate(SBS3_log = log2(SBS3),
Signature.G_log = log2(Signature.G))
ggscatter(sbs3_sigG_any1_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor()
sbs3_sigG_any1_yes <- sbs3 %>% dplyr::left_join(id_g) %>%
dplyr::filter(SBS3 >0 | Signature.G > 0) %>%
dplyr::mutate(SBS3_log = log2(SBS3+1),
Signature.G_log = log2(Signature.G+1))
ggscatter(sbs3_sigG_any1_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor()
sbs3_sigG_both_yes %>% dim
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor()+
ggtitle("n=48 tumors")
##
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor(size = 6)+
ggtitle("n=48 tumors")
sbs3_sigG_any1_yes %>% dim
ggscatter(sbs3_sigG_any1_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor(size = 6, method = "spearman")+
ggtitle("n=281 tumors")
pdf("SBS3_SignatureG_activityComparison.pdf", height = 5, width = 6)
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor(size = 6)+
ggtitle("n=48 tumors")
ggscatter(sbs3_sigG_any1_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
stat_cor(size = 6, method = "spearman")+
ggtitle("n=281 tumors")
dev.off()
getwd()
pdf("SBS3_SignatureG_activityComparison.pdf", height = 5, width = 6)
ggscatter(sbs3_sigG_both_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
#stat_cor(size = 6)+
ggtitle("n=48 tumors")
ggscatter(sbs3_sigG_any1_yes, x = "SBS3_log", y = "Signature.G_log")+
xlab("SBS3 activity (Log2)")+
ylab("Signature.G activity (Log2)")+
theme_minimal(base_size = 18)+
#stat_cor(size = 6, method = "spearman")+
ggtitle("n=281 tumors")
dev.off()
id_g %>% head
id_g %>% dplyr::filter(Signature.G > 0) %>% dim
id_g %>% dim
id_g %>% dplyr::filter(Signature.G > 0) %>% head
id_g %>% dplyr::filter(Signature.G > 0) %>% dplyr::filter(grepl("MB", Samples))
id_g %>% dplyr::filter(Signature.G > 0) %>% dplyr::filter(grepl("MB", Samples)) %>% dim()
id_g %>% dplyr::filter(grepl("MB", Samples)) %>% dim()
devtools::install_github("steverozen/ICAMS", ref = "v2.0.7-branch")
library(tidyverse)
library(ICAMS)
file <- c(system.file("extdata",
"Mutect.GRCh37.vcf",
package = "ICAMS"))
file
list.of.ID.vcfs <- ReadAndSplitMutectVCFs(file)$ID
list.of.ID.vcfs
list.of.ID.vcfs %>% head()
ReadAndSplitMutectVCFs(file)
list.of.ID.vcfs %>% class
list.of.ID.vcfs$Mutect.GRCh37
list.of.ID.vcfs$Mutect.GRCh37 %>% head
catID <- VCFsToIDCatalogs(list.of.ID.vcfs, ref.genome = "hg19",
region = "genome")
catID %>% head
catID %>% class
catID %>% as.data.frame() %>% head
catID %>% as.data.frame()
?PlotCatalog
PlotCatalog(catalog = catID)
PlotCatalog
PlotCatalog(catalog = catID)+
theme_classic()
PlotCatalog(catalog = catID)
PlotCatalogToPdf(catalog = catID)
PlotCatalogToPdf(catalog = catID, file = "~/Desktop/test.pdf")
PlotCatalogToPdf(catalog = catID, file = "~/Desktop/test.pdf", cex = 4)
PlotCatalog(catalog = catID, file = "~/Desktop/test.pdf", cex = 4)
PlotCatalog(catalog = catID, cex = 4)
PlotCatalogToPdf
ReadAndSplitMutectVCFs(file) %>% class
ReadAndSplitMutectVCFs(file) %>% head
?S4Vectors::as.vector.Rle
q()
plt + theme_classic(base_size = 18)+
geom_vline(xintercept = 170819708)
plt + theme_classic(base_size = 18)+
geom_vline(xintercept = 170819708)
BiocManager::install("karyoploteR")
library(karyoplotR)
library(karyoploteR)
data(genesymbol, package = "biovizBase")
wh <- genesymbol[c("NPM1")]
wh <- range(wh, ignore.strand = TRUE)
plt <- autoplot(Homo.sapiens, which = wh, color = "black")
plt + theme_classic(base_size = 18)+
geom_vline(xintercept = 170819708)
library(ggbio)
library(Homo.sapiens)
library(karyoploteR)
data(genesymbol, package = "biovizBase")
wh <- genesymbol[c("NPM1")]
wh <- range(wh, ignore.strand = TRUE)
plt <- autoplot(Homo.sapiens, which = wh, color = "black")
plt + theme_classic(base_size = 18)+
geom_vline(xintercept = 170819708)
wh
npm.region <- toGRanges("chr5:170809120-170819120")
npm.region <- range(npm.region, ignore.strand = TRUE)
plt <- autoplot(Homo.sapiens, which = wh, color = "black")
plt + theme_classic(base_size = 18)
plt <- autoplot(Homo.sapiens, which = npm.region, color = "black")
plt + theme_classic(base_size = 18)
rm(list = ls())
setwd("/Users/venu/Desktop/ServerView/MYC/scripts/data_30052018/downstreamAnalysis/trackPlots")
setwd("~/Desktop/ServerView/MYC/scripts/data_30052018/downstreamAnalysis/trackPlots")
library(tidyverse)
library(karyoploteR)
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
library(ggbio)
library(Homo.sapiens)
load("browserTracks.R.RData")
plt_npm1 <- autoplot(Homo.sapiens, which = npm.region, fill = "black")+
theme_classic(base_size = 18)+
theme(axis.text = element_text(color = "black"))
plt_npm1
npm.region <- toGRanges("chr5:170809120-170819120")
npm.region <- range(npm.region, ignore.strand = TRUE)
plt_npm1 <- autoplot(Homo.sapiens, which = npm.region, fill = "black")+
theme_classic(base_size = 18)+
theme(axis.text = element_text(color = "black"))
plt_npm1
plt
plt_npm1 +
geom_vline(xintercept = 170814120)
plt_npm1 <- plt_npm1 + geom_vline(xintercept = 170814120)
plt + plt_npm1 + patchwork::plot_layout(ncol = 1, heights = c(3, 1))
plt_npm1
plt_npm1 <- plt_npm1 + geom_vline(xintercept = 170814120)
plt + plt_npm1 + patchwork::plot_layout(ncol = 1, heights = c(3, 1))
plt + plt_npm1 + patchwork::plot_layout(ncol = 1)
plt_npm1 %>% class
plt_npm1
170814120+5000
npm.region <- toGRanges("chr5:170814120-170819120")
npm.region <- range(npm.region, ignore.strand = TRUE)
plt_npm1 <- autoplot(Homo.sapiens, which = npm.region, fill = "black")+
theme_classic(base_size = 18)+
theme(axis.text = element_text(color = "black"))
plt_npm1 <- plt_npm1 + geom_vline(xintercept = 170814120)
plt_npm1
plt
plt + plt_npm1
autoplot
ggbio::autoplot
plt_npm1 <- plt_npm1 + geom_vline(xintercept = 170814120)
plt_npm1
npm.region
npm.region <- toGRanges("chr5:170814120-170819120")
npm.region <- range(npm.region, ignore.strand = TRUE)
data(genesymbol, package = "biovizBase")
wh <- genesymbol[c("NPM1")]
wh <- range(wh, ignore.strand = TRUE)
wh
170814120 - 170814708
ls()
genes.data %>% head
wh <- genesymbol[c("NPM1")]
wh <- range(wh, ignore.strand = TRUE)
plt_npm1_gene <- autoplot(Homo.sapiens, which = wh, fill = "black")+
theme_classic(base_size = 18)+
theme(axis.text = element_text(color = "black"))
plt_npm1_gene
wh
170814708 + 5000
plt_npm1_gene +
geom_vline(xintercept = 170819708)
pdf("NPM1_geneStructure.pdf", height = 4, width = 6)
plt_npm1_gene +
geom_vline(xintercept = 170819708)
dev.off()
pdf("NPM1_geneStructure.pdf", height = 4, width = 10)
plt_npm1_gene +
geom_vline(xintercept = 170819708)
dev.off()
setwd("/Users/venu/Desktop/work/ISMB2019")
library(usethis)
#create_package("ISMB2019")
setwd("ISMB2019/")
devtools::document()
setwd("../")
devtools::install("ISMB2019/")
rtweet::tweet_shot("https://twitter.com/jhollist/status/947082036019388416")
webshot::install_phantomjs()
rtweet::tweet_shot("https://twitter.com/jhollist/status/947082036019388416")
rtweet::tweet_shot("https://twitter.com/nerd_yie/status/1155588573011333120")
rtweet::tweet_shot("https://twitter.com/nerd_yie/status/1155588573011333120")
setwd("/Users/venu/Desktop/work/ISMB2019")
remove.packages("ISMB2019")
setwd("/Users/venu/Desktop/work/ISMB2019")
library(usethis)
#create_package("ISMB2019")
setwd("ISMB2019/")
devtools::document()
q()
